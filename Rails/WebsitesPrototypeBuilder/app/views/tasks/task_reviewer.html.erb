<!DOCTYPE html>
<html>
<head>
<!--
<style> 
#txt
{
top:100px;
left:200px;
position:absolute;
width:300px;
height:100px;
box-shadow: 0px 0px 15px 2px violet;
border:none;
}

.btn{
position:absolute;
width:100px;
height:100px;
box-shadow: 0px 0px 15px 2px orange;
border:none;

}
</style>
-->

<!--
<style>
input:active, input:focus ,input:hover{
    box-shadow:0px 0px 10px 2px orange;
    border:0;
}
</style>
-->


<script>
function highlight(id)
{
  //alert(id);
var element= document.getElementById(id);
element.style.border='none';
element.style.boxShadow="0px 0px 6px 2px orange";
}
 
 function dehighlight(id){
  var element = document.getElementById(id);
  element.style.boxShadow= 'none';
  element.style.border=1;
 } 

 function dehighlight_all(){
  $("input").each(function(){
    dehighlight(this.id);
  });
 }
//document.getElementById('bttn').onclick='highlight(el_id)';
//alert("Would you please enter some text?"); 
</script>

<!--<script type="text/javascript">
function notEmpty(){
  var myTextField = document.getElementById('myText');
  if(myTextField.value != "")
    alert("You entered: " + myTextField.value)
  else
    alert("Would you please enter some text?")    
}
</script> -->

</head>
<body>

<div id="content">
  
<input id="cmp4" type="text"/>

<input type = "submit" value ="Step 1 cmp" class="btn" id='cmp'/>
<input type ="button" value = "Step 2 cmp" class= "btn" id= 'cmp2'/>
<input type ="button"  value= "Step 3 cmp" class="btn" id='cmp3' />

</div>

<%= form_for [@task,@step] do |f| %>  
  <%= hidden_field_tag "change_success", 'false' %>
  <%= hidden_field_tag "change_id", '1' %>
  <%= hidden_field_tag "start_time", '1' %>
  <%= hidden_field_tag "change_clicks", '0' %>
<% end %>


<script>
var currstep_element_id= "<%= @step.component %>";

//  $('#bttn').click(function() {
//   highlight(currstep_id);
// });


// $(document).ready(function() {
//     $("input").click(function(event) {
//         alert(event.target.id);
//     });
// });

// $(window).load(function (){
//   highlight(currstep_element_id); //when the page load the 1st step's elements are highlighted
// });


 var count =1;
 var currstep_id= "<%= @step.id %>";
 var step_event = "<%= @step.event %>";
 var step_answer_success ='true';
 var clicks_count = 0;
 var curr_time = "<%=Time.now.strftime("%I:%M:%S")%>";



 $("input").on(step_event, function(event) {

  var curr_element_id= event.target.id;
  if (curr_element_id == currstep_element_id) { //check if the correct element triggered the event

    count=count+1; 
    currstep_id = <%=@step.id%>+1;
    clicks_count=<%= @task_result.click%>+1;

    $("#change_id").val(currstep_id); //to increment the value of the curr step
    $("#start_time").val(curr_time); //set the time_from_start
    $("#change_clicks").val(clicks_count); //update clicks_count in DB
    $("#change_success").val(step_answer_success); //set successful = true for step_answer

    dehighlight(currstep_element_id); 
    
    alert ($("#change_clicks").val()); 
    $(function() { $("form").submit(); }); //to update the step_id in the DB

       }
    });

     $(window).load(function(){
       currstep_element_id= "<%=@step.component%>";  //update the variable to get curr_element_Value
       highlight(currstep_element_id);
       clicks_count= "<%= @task_result.click%>";

// initially loads the 1st cmp higlighted then loads with the nxt step's comp. highlighted
    });


  //    $("input").click( function(event) {

  // var curr_element_id= event.target.id;
  // if (curr_element_id == currstep_element_id) {
  //   count=count+1; 
  //  // curr_element_id= <%=@step.component%>;
  //   //alert("cmp"+count);
  //   highlight("cmp"+count);
  //   dehighlight(curr_element_id);
  //   curr_element_id="cmp"+count;
  //   currstep_element_id= curr_element_id;

  //  // alert (event.target.id + "clicked");

  //      }
  //   });

 // console.log( index + ": " + $(this).text() );
//    $( "input" ).each(function() {
// });
</script>
</body>
</html>