<html>

	<head>
		<title>Design Page</title>
		<link href="jquery-ui/css/ui-lightness/jquery-ui-1.9.2.custom.css" rel="stylesheet">
		<script src="jquery-ui/js/jquery-1.8.3.js"></script>
		<script src="jquery-ui/js/jquery-ui-1.9.2.custom.js"></script>

		<link rel="stylesheet" type="text/css" href="Style1.css">
		<script type="text/javascript">
			$(document).ready(function (){
				counter = 0; //Counts number of elements in the Design Page
				$(".drag").draggable({
					helper: 'clone',// clone the dragged element and drag the newly created one
					containment: 'designpage',// elements should be contained in design page not any other element
					cancel:false,// drag action not overriten by any other actions (ex. button's onClick event)
					start: function (event,ui){
						counter++; //When dragging starts, increment the counter
						$("#designpage").css({
							"z-index": "-1"
						});
					},
					stop: function(event, ui){
						$("#designpage").css({
							"z-index": "1"
						});
						var pos = $(ui.helper).offset();
						var pos1 = $("#designpage").offset();
						var name = "#element"+counter; //new element's name
						$(name).css({ //set posn of the new element
						"left": pos.left-pos1.left,
						"top": pos.top-pos1.top
						});
						if ($(name).parent().attr("id")!="designpage") {
							counter--;
							$(name).remove();
						}
						else{
							$(name).removeClass("drag");
							$(name).resizable({
								containment: 'parent',
								alsoResize: $(name).children(".toolboxelement"),
							    cancel: false,
						        start: function(event, ui){
						  	      ui.element.children(".toolboxelement").css({
						    	      "width": "100%" ,
						        	  "height": "100%"
						          });
						      },
	  					        resize: function(event, ui){
							       ui.element.children(".toolboxelement").css({
							       	  "width": "100%" ,
							          "height": "100%"
							       });
						        },
						        stop: function(event, ui){
							       ui.element.children(".toolboxelement").css({
							          "width": "100%" ,
							          "height": "100%"
							       });
						        }
							})
							.draggable({ //new draggable to avoid cloning elements that are moved within the design page
								containment: 'parent',
								cancel:false
							});
						}
					}
				});

				$("#designpage").droppable({
					drop: function(event, ui){
						// alert(ui.draggable.attr('id'));
						if (ui.draggable.attr('id').search(/element([0-9])/)==-1){ // if it is not an already dragged element
							var element = $(ui.draggable).clone(); // clone the dragged element
							element.attr("id","element"+counter); // change its id
							element.addClass("appended"); // give it class appended
							$(this).append(element); // add the element to the design page (writing html code to the div)
						}
					}
				});
			});
		</script>
	</head>

	<body>
		<!-- main div containing toolbox and design page -->
		<div id="main">
			<!-- toolbox containing elements to add to the design page -->
			<div id="toolbox">
				<!-- table with all the available toolbox elements -->
				<table>
					<thead><h3 style="text-align: center">Toolbox</h3></thead>
					<tbody>
						<tr>
							<td class="tbldevs">
								<div id="buttondiv" class="drag toolboxelement">
									<button class="toolboxelement">Button</button>
								</div>
							</td>
						</tr>
						<tr>
							<td class="tbldevs">
								<div id="imagediv" class="drag toolboxelement">
									<img src="gimg.jpg" width="20px" hight="20px" class="toolboxelement">
								</div>
							</td>
						</tr>
						<tr>
							<td class="tbldevs">
								<div id="labeldiv" width="20" class="drag toolboxelement" style="background-color: red">
									<label class="toolboxelement">Label</label>
								</div>
							</td>
						</tr>
						<tr>
							<td class="tbldevs">
								<div id="hyperlinkdiv" class="drag toolboxelement">
									<a href="#" class="toolboxelement">Hyperlink</a>
								</div>
							</td>
						</tr>
						<tr>
							<td class="tbldevs">
								<div id="textareadiv" class="drag toolboxelement">
									<textarea class="toolboxelement" style="resize: none">Text Area</textarea>
								</div>
							</td>
						</tr>
					</tbody>
				</table>

			</div>
			<!-- empty design page -->
			<div id="designpage" class="ui-widget-content">
				<p>Design page here</p>
			</div>
		</div>
	</body>

</html>